$size: 60px;
$nextZIndex: 1;
$currentZIndex: $nextZIndex + 1;
$borderRadius: 16px;
$borderRadiusCovered: 20px;

@mixin pseudoCard() {
  position: absolute;
  top: 0;
  left: 0;
  width: $size;
  height: $size;
  content: '';
}

@mixin firstCard() {
  transform: translateY(5px) scale(1);

  > img {
    border-radius: $borderRadius;
  }

  &:after {
    display: initial;
    content: initial;
  }
}

@mixin secondCard() {
  transform: translateY(0) scaleX(0.9);

  > img {
    border-radius: $borderRadiusCovered;
  }

  &:after {
    @include pseudoCard;

    border-radius: $borderRadius;
    background-color: rgb(194 194 194);
  }
}

@mixin thirdCard() {
  transform: translateY(-5px) scaleX(0.8);

  > img {
    border-radius: $borderRadiusCovered;
  }

  &:after {
    @include pseudoCard;

    border-radius: $borderRadius;
    background-color: rgb(245 245 245);
  }
}

[data-flipping-cards] {
  position: relative;
  width: $size;
  height: $size;
  display: inline-block;
  margin-top: -50%;
  transform: translateY(25%);

  .card {
    position: absolute;
    width: $size;
    height: $size;
    display: inline-block;
    transition:
      transform 300ms,
      opacity 200ms;

    img {
      max-width: 100%;
      height: auto;
    }

    &[data-order='1'] {
      @include firstCard;

      z-index: $currentZIndex;
    }

    &[data-order='2'] {
      @include secondCard;

      z-index: $nextZIndex;
    }

    &[data-order='3'] {
      @include thirdCard;
    }

    &:not([data-order='1'], [data-order='2'], [data-order='3']) {
      visibility: hidden;
    }
  }

  &[data-transition] {
    .card {
      &[data-order='1'] {
        opacity: 0;
      }

      &[data-order='2'] {
        @include firstCard;
      }

      &[data-order='3'] {
        @include secondCard;
      }

      &[data-order='4'] {
        @include thirdCard;
      }
    }
  }
}
