<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Petrov Dima</title>

    <link href="/src/tailwind-root.css" rel="stylesheet" />
    <link href="/src/my.scss" rel="stylesheet" />
  </head>

  <body class="m-auto flex flex-col gap-y-16 leading-[1.5em] lg:max-w-[856px]">
    <div class="relative flex justify-center">
      <div
        class="relative max-w-[508px] flex-[1_1_100%] overflow-hidden pb-[60vh] opacity-100 delay-500 duration-500 lg:max-w-[856px]"
      >
        <h2 class="absolute top-10 lg:top-20">
          <img src="/images/avatars/dima.svg" />
        </h2>

        <div class="flex flex-col gap-y-16 text-[40px] leading-[1.5em]">
          <div class="mt-[320px] text-gray-950">
            <span>
              I'm build world-class technology systems for software company.
            </span>

            <span data-animated-logo-cards>
              <img
                class="logo-mini-card current"
                src="/images/logos/ya.png"
                alt="ya"
              />
              <img
                class="logo-mini-card next"
                src="/images/logos/ff.png"
                alt="ff"
              />
              <img class="logo-mini-card" src="/images/logos/pt.png" alt="pt" />
              <img
                class="logo-mini-card"
                src="/images/logos/gpb.png"
                alt="gpb"
              />
              <img
                class="logo-mini-card"
                src="/images/logos/solar.png"
                alt="solar"
              />
            </span>

            <span data-animated-characters>We are a tight-knit team</span>

            <span data-animated-avatars-container>
              <span data-animated-avatars class="avatar">
                <img src="/images/logos/ya.png" alt="ya" />
              </span>

              <span data-animated-avatars class="avatar">
                <img src="/images/logos/ff.png" alt="ff" />
              </span>

              <span data-animated-avatars class="avatar">
                <img src="/images/logos/pt.png" alt="pt" />
              </span>
            </span>

            <span data-animated-characters>
              with 12 years of experience helping founders showcase how good
              their products really are.
            </span>
          </div>

          <div class="text-gray-950">
            <span data-animated-characters>
              Pulling everything together comes at the expense of your product.
              Your team should never stop shipping. That's where we step in.
            </span>
          </div>

          <div class="text-gray-950">
            <span data-animated-characters>
              We design and build the perfect site for your product. We move
              fast, while ensuring the highest level of craft, attention to
              detail and performance.
            </span>
          </div>

          <div class="text-gray-950">
            <span data-animated-characters>
              Projects start at $3,000/wk and they run for at least 8 weeks.
            </span>
          </div>

          <div class="text-gray-950">
            <span data-animated-characters>
              Your product deserves a better site. Book a call
            </span>
          </div>
        </div>
      </div>

      <div
        class="absolute bottom-[100px] px-6 pt-32 leading-[1.8] font-medium text-[#232323]/40 opacity-100 delay-500 lg:bottom-20"
      >
        <div>
          Drop me a line at
          <div
            class="inline-flex translate-y-0.5 cursor-pointer items-center hover:text-[#232323]/80"
          >
            <div class="relative flex h-4 w-4 items-center justify-center">
              <img src="/images/icons/copy.svg" />
            </div>
            <span class="transition-color ml-1 text-inherit duration-150">
              hey@petrovdima.ru
            </span>
          </div>
        </div>
        <p>© 2025</p>
      </div>
    </div>

    <script type="module">
      import { initSmoothScroll } from './src/scroll.js';
      import { gsap } from 'gsap';
      import SplitType from 'split-type';

      initSmoothScroll();

      /** @typedef ScrollTriggerConfig
       * @property {ScrollTrigger.Vars} scrollTrigger
       * */

      /**
       * @param {HTMLElement | HTMLElement[]  | string} trigger
       * @param {ScrollTrigger.Vars} options
       * @returns ScrollTriggerConfig
       * */
      function scrollTrigger(trigger, options) {
        return {
          scrollTrigger: {
            start: 'top 40%', // анимация запускается, когда группа символов достигает x% скрола сверху экрана
            scrub: true, // привязка к позиции скрола, а не ко времени
            trigger: trigger,
            ...options,
          },
        };
      }

      const animatedCharacters = gsap.utils.toArray(
        '[data-animated-characters]'
      );

      const splattedTypes = animatedCharacters.map(
        (spanElement) => new SplitType(spanElement, { types: 'words' })
      );
      /** @type {HTMLElement[]} */
      const splattedWords = splattedTypes.flatMap((type) => type.words);

      gsap.from(splattedWords, {
        opacity: 0.2, // gsap.from, поэтому начиная с этой прозрачности и до 1
        stagger: 0.1, // задержка между элементами - каждый следующий через 0.1 секунды
        color: 'var(--color-gray-950)',
        ...scrollTrigger(splattedWords, {
          end: 'bottom 40%', // анимация завершается, когда группа символов достигает y% скрола снизу экрана
          endTrigger: splattedWords.at(-1),
          // markers: true,
        }),
      });

      const animatedAvatarContainers = document.querySelectorAll(
        '[data-animated-avatars-container]'
      );
      animatedAvatarContainers.forEach((avatarElement) => {
        gsap.from(avatarElement, {
          width: 0,
          display: 'inline-flex',
          ...scrollTrigger(avatarElement, {
            end: 'top 40%', // анимация завершается, когда группа символов достигает y% скрола сверху экрана
          }),
        });
      });

      gsap.from('[data-animated-avatars-container] [data-animated-avatars]', {
        scale: 0,
        duration: 1,
        transformOrigin: '0px 50%',
        stagger: 1, // задержка между элементами - каждый следующий через 1 секунду
        ...scrollTrigger('[data-animated-avatars-container]', {
          end: 'top 35%', // анимация завершается, когда группа символов достигает y% скрола сверху экрана
        }),
      });

      const logoCardsContainers = document.querySelectorAll(
        '[data-animated-logo-cards]'
      );
      logoCardsContainers.forEach((container) => {
        function findNextCard() {
          const cards = container.querySelectorAll(
            '.logo-mini-card:not(.current)'
          );
          return cards[0];
        }
        function findCurrentCard() {
          return container.querySelector('.logo-mini-card.current');
        }

        container.addEventListener('mouseenter', () => {
          const nextCard = findNextCard();
          if (nextCard != null) {
            nextCard.classList.add('elevated');
          }
        });
        container.addEventListener('mouseleave', () => {
          const nextCard = findNextCard();
          if (nextCard != null) {
            nextCard.classList.remove('elevated');
          }
        });
        container.addEventListener('click', async () => {
          const currentCard = findCurrentCard();
          const nextCard = findNextCard();
          if (currentCard == null && nextCard == null) {
            return;
          }

          if (!nextCard.classList.contains('elevated')) {
            nextCard.classList.add('elevated');
            await new Promise((resolve) => {
              setTimeout(resolve, 300);
            });
          }

          container.removeChild(currentCard);
          currentCard.classList.remove('current');
          container.appendChild(currentCard);

          nextCard.classList.remove('elevated');
          nextCard.classList.remove('next');
          nextCard.classList.add('current');

          const furtherNextCard = findNextCard();
          furtherNextCard.classList.add('next');
        });
      });
    </script>
  </body>
</html>
